#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏

echo "ü§ñ –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ MB '25"
echo "=========================="
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ CSV —Ñ–∞–π–ª–∞
if [ ! -f "broadcast.csv" ]; then
    echo "‚ùå –§–∞–π–ª broadcast.csv –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    echo "–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º."
    exit 1
fi

echo "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:"
echo "1) Dry-run (—Å–∏–º—É–ª—è—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ)"
echo "2) –†–µ–∞–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞"
echo "3) –¢–µ—Å—Ç —Å —Ç–µ—Å—Ç–æ–≤—ã–º —Ñ–∞–π–ª–æ–º"
echo ""
read -p "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä (1-3): " choice

case $choice in
    1)
        echo "üîç –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Å–∏–º—É–ª—è—Ü–∏–∏..."
        python3 broadcast_script.py
        ;;
    2)
        echo "‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –†–µ–∞–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞!"
        echo "–°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º."
        read -p "–í—ã —É–≤–µ—Ä–µ–Ω—ã? (y/N): " confirm
        if [[ $confirm == [yY] || $confirm == [yY][eE][sS] ]]; then
            python3 broadcast_script.py --send
        else
            echo "‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º."
        fi
        ;;
    3)
        if [ ! -f "test_broadcast.csv" ]; then
            echo "‚ùå –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª test_broadcast.csv –Ω–µ –Ω–∞–π–¥–µ–Ω!"
            exit 1
        fi
        echo "üß™ –ó–∞–ø—É—Å–∫ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏..."
        python3 broadcast_script.py --csv test_broadcast.csv
        ;;
    *)
        echo "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!"
        exit 1
        ;;
esac

echo ""
echo "‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ!"